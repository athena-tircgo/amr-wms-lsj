<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>PTS ⇄ WMS 通訊規格書</title>

<!-- Markdown 解析 -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<!-- Mermaid -->
<script type="module">
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ startOnLoad: false });
  window.renderMermaid = () => mermaid.init();
</script>

<style>
body {
  font-family: "Noto Sans TC", sans-serif;
  max-width: 960px;
  margin: 40px auto;
  line-height: 1.6;
  color: #222;
  background-color: #fdfdfd;
  padding: 0 24px;
}

/* 表格 */
table {
  border-collapse: collapse !important;
  width: 100%;
  margin: 1.5em 0;
  font-size: 15px;
  border: 1px solid #000 !important;
}
th, td {
  border: 1px solid #000 !important;
  padding: 10px 14px;
  text-align: left;
}
th {
  background-color: #e0e0e0;
  font-weight: 600;
}
tr:nth-child(even) { background-color: #f8f8f8; }
tr:hover { background-color: #f0f6ff; }

/* 標題顏色 */
h1 { 
  color: #004b8d; 
  text-align: center; 
  margin-top: 150px;
}
h2, h3 { color: #004b8d; }

/* Mermaid note 透明化 */
.mermaid .note rect {
  fill: transparent !important;
  stroke: none !important;
}
.mermaid .note text { fill: #000 !important; }

/* 列印 PDF */
@media print {
  h2, h3 {
    page-break-before: always;
  }
  table, th, td { border: 1px solid #000 !important; }
  th { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  tr:nth-child(even) { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  tr { page-break-inside: avoid; }
  table { page-break-inside: auto; }
}
</style>
</head>

<body>
<div id="content">🚀 正在載入 README.md...</div>

<script>
fetch("README.md")
  .then(res => res.text())
  .then(text => {
    // 將 Markdown 轉 HTML
    const html = marked.parse(text);
    const container = document.getElementById("content");
    container.innerHTML = html;

    // 將 ```mermaid``` 代碼區塊轉為 Mermaid div
    document.querySelectorAll("pre code.language-mermaid").forEach(block => {
      const parent = block.parentElement;
      const div = document.createElement("div");
      div.className = "mermaid";
      div.innerHTML = block.textContent.trim();
      parent.replaceWith(div);
    });

    // 渲染 Mermaid
    if (window.renderMermaid) window.renderMermaid();
  })
  .catch(err => {
    document.getElementById("content").innerHTML = "❌ 載入失敗：" + err;
  });
</script>

</body>
</html>
